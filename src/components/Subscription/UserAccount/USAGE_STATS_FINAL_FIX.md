# ç”¨é‡çµ±è¨ˆé¡¯ç¤ºå•é¡Œ - æœ€çµ‚ä¿®å¾©

## ğŸ” å•é¡Œæ ¹æºåˆ†æ

é€šéåˆ†æå¾Œç«¯æ—¥èªŒå’Œå‰ç«¯ Consoleï¼Œç™¼ç¾äº†å…©å€‹é—œéµå•é¡Œï¼š

### 1. ç«¯é»æ˜ å°„éŒ¯èª¤
**å•é¡Œ**ï¼šå¾Œç«¯åœ¨æ§‹å»ºç”¨é‡çµ±è¨ˆå›æ‡‰æ™‚ä½¿ç”¨äº†éŒ¯èª¤çš„ç«¯é»è·¯å¾‘
- å¯¦éš›æ•¸æ“šå­˜å„²åœ¨ï¼š`lohasSpectrum`, `marketSentiment`, `watchlist`
- ä½†ä»£ç¢¼æŸ¥æ‰¾ï¼š`/api/stock/analysis`, `/api/market-sentiment`, `/api/watchlist`

**çµæœ**ï¼šæ‰€æœ‰ç”¨é‡éƒ½é¡¯ç¤ºç‚º 0ï¼Œå› ç‚ºæ‰¾ä¸åˆ°å°æ‡‰çš„æ•¸æ“š

### 2. æ¯æ—¥é™åˆ¶é…ç½®éŒ¯èª¤
**å•é¡Œ**ï¼šæ‰€æœ‰åŠŸèƒ½çš„æ¯æ—¥é™åˆ¶éƒ½è¨­ç½®ç‚º `-1`ï¼ˆç„¡é™åˆ¶ï¼‰
- å…è²»ç”¨æˆ¶æ‡‰è©²æœ‰æ¯æ—¥é™åˆ¶ï¼Œä½†é…ç½®ç‚ºç„¡é™åˆ¶
- å°è‡´å‰ç«¯é¡¯ç¤ºç„¡é™ç¬¦è™Ÿ (âˆ)

## ğŸ› ï¸ ä¿®å¾©æªæ–½

### 1. ä¿®å¾©ç«¯é»æ˜ å°„ (`auth.controller.js`)
```javascript
// ä¿®å¾©å‰
used: dailyStats.endpoints['/api/stock/analysis'] || 0

// ä¿®å¾©å¾Œ  
used: dailyStats.endpoints['lohasSpectrum'] || 0
```

### 2. ä¿®å¾©æ¯æ—¥é™åˆ¶é…ç½® (`plans.config.js`)
```javascript
// ä¿®å¾©å‰
lohasSpectrum: {
    daily: -1, // ç„¡é™åˆ¶
    monthly: 5
}

// ä¿®å¾©å¾Œ
lohasSpectrum: {
    daily: 5,  // èˆ‡æœˆé™åˆ¶ç›¸åŒ
    monthly: 5
}
```

## ğŸ“Š ä¿®å¾©å¾Œçš„é æœŸçµæœ

åŸºæ–¼æ—¥èªŒä¸­çš„å¯¦éš›æ•¸æ“šï¼š
- **æ¯æ—¥ lohasSpectrum**ï¼šused=5, limit=5 (100% ä½¿ç”¨ç‡)
- **æ¯æœˆ lohasSpectrum**ï¼šused=5, limit=5 (100% ä½¿ç”¨ç‡)
- **marketSentiment**ï¼šused=0, limit=2 (0% ä½¿ç”¨ç‡)
- **watchlist**ï¼šused=0, limit=0 (åŠŸèƒ½ç¦ç”¨)

## ğŸ§ª é©—è­‰æ–¹æ³•

1. **é‡æ–°å•Ÿå‹•å¾Œç«¯æœå‹™**ä»¥è¼‰å…¥é…ç½®æ›´æ”¹
2. **è¨ªå•ç”¨æˆ¶å¸³æˆ¶é é¢**
3. **æª¢æŸ¥ç€è¦½å™¨ Console**ä¸­çš„èª¿è©¦æ—¥èªŒï¼š
   ```
   ğŸ“Š Usage stats from API: {daily: {...}, monthly: {...}}
   ğŸ“Š UsageStats Debug: {stats: {...}, hasStats: true, ...}
   ```
4. **é©—è­‰é¡¯ç¤º**ï¼š
   - æ¯æ—¥å’Œæ¯æœˆçš„ lohasSpectrum éƒ½æ‡‰é¡¯ç¤º 5/5 (100%)
   - ä¸å†é¡¯ç¤ºç„¡é™ç¬¦è™Ÿ
   - é€²åº¦æ¢æ‡‰æ­£ç¢ºåæ˜ ä½¿ç”¨ç‡

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. `backend/src/modules/auth/controllers/auth.controller.js`
   - ä¿®å¾©ç«¯é»æ˜ å°„é‚è¼¯

2. `backend/src/config/plans.config.js`
   - ä¿®å¾©æ¯æ—¥é™åˆ¶é…ç½®
   - çµ±ä¸€å…è²»æ–¹æ¡ˆçš„æ¯æ—¥å’Œæ¯æœˆé™åˆ¶

3. `backend/src/scripts/test-usage-stats-fix.js`
   - æ–°å¢æ¸¬è©¦è…³æœ¬é©—è­‰ä¿®å¾©

## ğŸ¯ æ¥­å‹™é‚è¼¯èªªæ˜

- **å…è²»ç”¨æˆ¶**ï¼šæ¯æ—¥å’Œæ¯æœˆé™åˆ¶ç›¸åŒï¼ˆå› ç‚ºæˆ‘å€‘ä¸»è¦æŒ‰æœˆè¨ˆè²»ï¼‰
- **Pro ç”¨æˆ¶**ï¼šæ‰€æœ‰åŠŸèƒ½ç„¡é™åˆ¶ (-1)
- **æ•¸æ“šä¸€è‡´æ€§**ï¼šç¢ºä¿å¾Œç«¯å­˜å„²çš„ key èˆ‡æŸ¥æ‰¾çš„ key ä¸€è‡´

é€™å€‹ä¿®å¾©è§£æ±ºäº†ç”¨é‡çµ±è¨ˆé¡¯ç¤ºä¸æ­£ç¢ºçš„æ ¸å¿ƒå•é¡Œï¼Œç¾åœ¨ç”¨æˆ¶å¯ä»¥æº–ç¢ºçœ‹åˆ°ä»–å€‘çš„ API ä½¿ç”¨æƒ…æ³ã€‚